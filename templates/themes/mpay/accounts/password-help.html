{% load theming %}{% load static %}
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, viewport-fit=cover" />
  <title>Esqueci minha senha — MPay</title>

  <!-- Ícones -->
  <link rel="icon" href="{% themed_static 'images/logo/favicon.png' %}" type="image/png" />
  <link rel="apple-touch-icon" href="{% themed_static 'images/logo/favicon.png' %}" />

  <!-- Fontes e CSS do tema -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@100;300;400;700;900&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="{% themed_static 'css/vendors/bootstrap.min.css' %}" />
  <link rel="stylesheet" href="{% themed_static 'css/vendors/swiper-bundle.min.css' %}" />
  <link rel="stylesheet" href="{% themed_static 'css/style.css' %}" />
  <link rel="stylesheet" href="{% themed_static 'css/overrides.css' %}" />

</head>

<body class="mpay-theme auth-body">

  <!-- HEADER (baseado no Help.html) -->
  <div class="auth-header">
    <div class="help-head d-flex">
      <a href="{% url 'accounts:login' %}" class="back-btn"><i class="back-btn" data-feather="arrow-left"></i></a>
      <h2>Esqueci minha senha</h2>
    </div>
    <div class="head-img text-center">
      <img class="img-fluid img2" src="{% themed_static 'images/authentication/help.svg' %}" alt="Ajuda" />
    </div>
  </div>

  {% if not submitted %}
  <!-- ===== ESTADO: FORM (inspirado em change-password.html) ===== -->
  <section class="section-t-space">
    <div class="custom-container">
      <h4 class="fw-normal light-text lh-base">
        Informe seu <strong>e-mail cadastrado</strong> (ou telefone) para receber instruções de redefinição.
      </h4>

      <form method="post" class="auth-form theme-form pt-0 mt-3">
        {% csrf_token %}
        <div class="form-group">
          <label for="email_or_phone" class="form-label">E-mail ou telefone</label>
          <input
            type="text"
            id="email_or_phone"
            name="email_or_phone"
            class="form-control"
            placeholder="seu-email@exemplo.com"
            inputmode="email"
            autocomplete="email"
            enterkeyhint="done"
            required
          />
        </div>

        <button class="btn theme-btn w-100" type="submit"
                onclick="try{fbq('trackCustom','PasswordHelpSubmit')}catch(e){}">
          Enviar instruções
        </button>

        <h4 class="signup mt-3">Lembrou a senha? <a href="{% url 'accounts:login' %}">Entrar</a></h4>
      </form>
    </div>
  </section>

  {% else %}
  <!-- ===== ESTADO: SUCESSO (animação do pay-successfully.html) ===== -->
  <section class="section-b-space">
    <div class="custom-container">
      <div class="successfully-pay text-center my-3">
        <img class="img-fluid pay-img" src="{% themed_static 'images/gif/successfull-payment.gif' %}" alt="Sucesso" />
      </div>

      <div class="text-center mb-3">
        <h4>Se o endereço existir, enviaremos um link para redefinir a senha.</h4>
        <p class="light-text">Verifique sua caixa de entrada e também a pasta de spam.</p>
      </div>

      <a href="{% url 'accounts:login' %}" class="btn theme-btn successfully w-100 mb-2">Voltar ao login</a>
      <a href="{% url 'core:home' %}" class="btn gray-btn w-100">Ir para a Home</a>
    </div>
  </section>
  {% endif %}

  <!-- JS -->
  <script src="{% themed_static 'js/feather.min.js' %}"></script>
  <script src="{% themed_static 'js/custom-feather.js' %}"></script>
  <script src="{% themed_static 'js/bootstrap.bundle.min.js' %}"></script>
  <script src="{% themed_static 'js/script.js' %}"></script>

  <!-- Placeholder não some ao focar -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      var el = document.getElementById('email_or_phone');
      if (el) {
        el.setAttribute('autocapitalize','none');
        el.addEventListener('focus', function(){
          if(!this.placeholder) this.placeholder = 'suporte@mpaybank.cash';
        });
        el.addEventListener('blur', function(){
          if(!this.placeholder) this.placeholder = 'suporte@mpaybank.cash';
        });
      }
    });
  </script>
</body>
</html>
