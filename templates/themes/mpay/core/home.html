{% load static theming %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <meta name="theme-color" content="#122636"/>

  <!-- === PIXELS (cópia fiel do Cointex home) === -->
  <script>
    !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){
      n.callMethod?n.callMethod.apply(n,arguments):n.queue.push(arguments)};
      if(!f._fbq)f._fbq=n; n.push=n; n.loaded=!0;n.version='2.0';
      n.queue=[]; t=b.createElement(e); t.async=!0;
      t.src=v; s=b.getElementsByTagName(e)[0];
      s.parentNode.insertBefore(t,s)
    }(window, document,'script','https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '1414661506543941');
    fbq('init', '24796423593276136');
    fbq('init', '780359434541574');
    fbq('track', 'PageView');
  </script>
  <noscript>
    <img height="1" width="1" style="display:none"
         src="https://www.facebook.com/tr?id=1414661506543941&ev=PageView&noscript=1"/>
    <img height="1" width="1" style="display:none"
         src="https://www.facebook.com/tr?id=24796423593276136&ev=PageView&noscript=1"/>
    <img height="1" width="1" style="display:none"
         src="https://www.facebook.com/tr?id=780359434541574&ev=PageView&noscript=1"/>
  </noscript>

  <script
    src="https://cdn.utmify.com.br/scripts/utms/latest.js"
    data-utmify-prevent-xcod-sck
    data-utmify-prevent-subids
    async
    defer
  ></script>
  <script>
    window.pixelId = "68c4b6df444a2a1e6ba9ed17";
    (function(){
      var a = document.createElement("script");
      a.setAttribute("async", ""); a.setAttribute("defer", "");
      a.setAttribute("src", "https://cdn.utmify.com.br/scripts/pixel/pixel.js");
      document.head.appendChild(a);
    })();
  </script>

  <!-- TikTok Pixel -->
  <script>
    !function (w, d, t) {
      w.TiktokAnalyticsObject=t;var ttq=w[t]=w[t]||[];
      ttq.methods=["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie","disableCookie"];
      ttq.setAndDefer=function(t,e){t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}};
      for(var i=0;i<ttq.methods.length;i++)ttq.setAndDefer(ttq,ttq.methods[i]);
      ttq.instance=function(t){for(var e=ttq._i[t]||[],n=0;n<ttq.methods.length;n++)ttq.setAndDefer(e,ttq.methods[n]);return e};
      ttq.load=function(e,n){var i="https://analytics.tiktok.com/i18n/pixel/events.js";
      ttq._i=ttq._i||{},ttq._i[e]=[],ttq._i[e]._u=i,ttq._t=ttq._t||{},ttq._t[e]=+new Date;
      n=n||{};var o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src=i+"?sdkid="+e+"&lib="+t;
      var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(o,a)};
      ttq.load('D31KIHJC77U0B8UM6JJG'); ttq.page();
    }(window, document, 'ttq');
  </script>
  <!-- /Pixels -->

  <title>MPay — Início</title>

  <!-- CSS (sempre via themed_static; nada de “mpay/assets/…”) -->
  <link rel="stylesheet" href="{% themed_static 'css/bootstrap.min.css' %}">
  <link rel="stylesheet" href="{% themed_static 'css/swiper-bundle.min.css' %}">
  <link rel="stylesheet" href="{% themed_static 'css/style.css' %}">

  <style>
    /* Layout “app-like” */
    html, body { height: 100%; background: #0e1a24; }
    body { display: flex; flex-direction: column; }
    .app-shell { display: flex; flex-direction: column; min-height: 100vh; }
    .app-content { flex: 1 1 auto; padding-bottom: 70px; } /* espaço para a navbar */
    .tab-view { display: none; }
    .tab-view.active { display: block; }

    /* Navbar inferior */
    .app-nav {
      position: fixed; left: 0; right: 0; bottom: 0;
      height: 60px; background: #122636; z-index: 1000;
      border-top: 1px solid rgba(255,255,255,.06);
      display: grid; grid-template-columns: repeat(4,1fr);
    }
    .app-nav a {
      display:flex; flex-direction:column; align-items:center; justify-content:center;
      text-decoration:none; color:#9fb3c8; font-size:.75rem;
    }
    .app-nav a.active { color:#20c997; }
    .app-nav svg { width: 22px; height: 22px; margin-bottom: 2px; }

    /* Títulos/seções */
    .screen-header { padding: 16px; color: #e8f0f6; }
    .brand-mini { display:flex; align-items:center; gap:10px; }
    .brand-mini img { width:28px; height:28px; border-radius:8px; }
    .card-ghost { background:#122636; border-radius:14px; padding:16px; margin: 0 16px 16px; color:#e8f0f6; }

    /* Ajustes de imagens do template MPay */
    .img-fluid { max-width: 100%; height: auto; }
  </style>
</head>
<body>

<div class="app-shell">
  <!-- Header pequenininho com logo -->
  <header class="screen-header">
    <div class="brand-mini">
      <img src="{% themed_static 'images/logo/48.png' %}" alt="MPay">
      <strong>MPay</strong>
    </div>
  </header>

  <!-- Conteúdo das “abas” (cada uma é a fusão do respectivo template) -->
  <main class="app-content">

    <!-- =============== ABA 1: LANDING (base = landing.html) =============== -->
    <section id="tab-landing" class="tab-view active" role="region" aria-labelledby="nav-landing">
      <!-- recorte essencial do landing: banner/atalhos/teasers -->
      <div class="card-ghost">
        <h5 class="mb-2">Bem-vindo(a) à MPay</h5>
        <p class="mb-0" style="opacity:.8">Sua carteira digital internacional no Brasil.</p>
      </div>

      <!-- exemplo de hero/ilustração -->
      <div class="px-3 mb-3">
        <img class="img-fluid rounded-3"
             src="{% themed_static 'images/background/auth-bg.jpg' %}"
             alt="MPay">
      </div>

      <!-- atalhos do landing -->
      <div class="row g-2 px-3 mb-3">
        <div class="col-6">
          <a class="card-ghost d-block text-decoration-none" href="#">
            <div class="d-flex align-items-center gap-2">
              <img src="{% themed_static 'images/svg/mpay.svg' %}" alt="" width="22" height="22">
              <div>Adicionar saldo</div>
            </div>
          </a>
        </div>
        <div class="col-6">
          <a class="card-ghost d-block text-decoration-none" href="#">
            <div class="d-flex align-items-center gap-2">
              <img src="{% themed_static 'images/svg/scan.svg' %}" alt="" width="22" height="22">
              <div>PIX / QR</div>
            </div>
          </a>
        </div>
      </div>
    </section>

    <!-- =============== ABA 2: CRYPTO (base = crypto.html) =============== -->
    <section id="tab-crypto" class="tab-view" role="region" aria-labelledby="nav-crypto">
      <div class="card-ghost">
        <h5 class="mb-2">Mercado</h5>
        <p class="mb-0" style="opacity:.8">Cotação e variação em tempo real.</p>
      </div>

      <!-- placeholder simples (integraremos dados depois) -->
      <div class="px-3">
        <div class="card-ghost">
          <div class="d-flex justify-content-between align-items-center">
            <div class="d-flex align-items-center gap-2">
              <img src="{% themed_static 'images/svg/bitcoin.svg' %}" width="22" height="22" alt="">
              <strong>Bitcoin</strong>
            </div>
            <span style="color:#20c997">+0,00%</span>
          </div>
          <small style="opacity:.7">Em breve conectamos aos seus dados.</small>
        </div>
      </div>
    </section>

    <!-- =============== ABA 3: INSIGHTS (base = insight.html) =============== -->
    <section id="tab-insight" class="tab-view" role="region" aria-labelledby="nav-insight">
      <div class="card-ghost">
        <h5 class="mb-2">Insights</h5>
        <p class="mb-0" style="opacity:.8">Dicas, notícias e alertas personalizados.</p>
      </div>

      <div class="px-3">
        <div class="card-ghost">
          <div class="d-flex align-items-center gap-2 mb-2">
            <img src="{% themed_static 'images/svg/megaphone.svg' %}" width="20" height="20" alt="">
            <strong>Feed MPay</strong>
          </div>
          <small style="opacity:.7">Conteúdo será alimentado aqui.</small>
        </div>
      </div>
    </section>

    <!-- =============== ABA 4: PERFIL (base = profile.html) =============== -->
    <section id="tab-profile" class="tab-view" role="region" aria-labelledby="nav-profile">
      <div class="card-ghost">
        <div class="d-flex align-items-center gap-3">
          <img class="img-fluid" src="{% themed_static 'images/person/p1.png' %}" alt="avatar" style="width:56px;height:56px;border-radius:14px;">
          <div>
            <h6 class="mb-1">Sua conta</h6>
            <small style="opacity:.7">Gerencie preferências, segurança e mais.</small>
          </div>
        </div>
      </div>

      <div class="px-3">
        <a class="card-ghost d-block text-decoration-none" href="#">
          <div class="d-flex align-items-center gap-2">
            <img src="{% themed_static 'images/svg/user.svg' %}" width="20" height="20" alt="">
            <div>Dados pessoais</div>
          </div>
        </a>
        <a class="card-ghost d-block text-decoration-none" href="#">
          <div class="d-flex align-items-center gap-2">
            <img src="{% themed_static 'images/svg/lock.svg' %}" width="20" height="20" alt="">
            <div>Segurança</div>
          </div>
        </a>
      </div>
    </section>

  </main>

  <!-- Navbar inferior (4 abas) -->
  <nav class="app-nav" aria-label="Navegação principal">
    <a id="nav-landing" href="#tab=landing" class="active" data-target="tab-landing" aria-controls="tab-landing" aria-current="page">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.6" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0h6"/></svg>
      <span>Início</span>
    </a>
    <a id="nav-crypto" href="#tab=crypto" data-target="tab-crypto" aria-controls="tab-crypto">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentColor" fill="none"><path d="M3 3h18v18H3z" stroke-width="1.6"/><path d="M7 14l3-3 3 3 4-4" stroke-width="1.6"/></svg>
      <span>Cripto</span>
    </a>
    <a id="nav-insight" href="#tab=insight" data-target="tab-insight" aria-controls="tab-insight">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentColor" fill="none"><path d="M12 3v18M3 12h18" stroke-width="1.6"/></svg>
      <span>Insights</span>
    </a>
    <a id="nav-profile" href="#tab=profile" data-target="tab-profile" aria-controls="tab-profile">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="currentColor" fill="none"><path d="M12 12a5 5 0 100-10 5 5 0 000 10z" stroke-width="1.6"/><path d="M20 21a8 8 0 10-16 0" stroke-width="1.6"/></svg>
      <span>Perfil</span>
    </a>
  </nav>
</div>

<!-- JS (sempre via themed_static) -->
<script src="{% themed_static 'js/bootstrap.bundle.min.js' %}"></script>
<script src="{% themed_static 'js/feather.min.js' %}"></script>
<script src="{% themed_static 'js/swiper-bundle.min.js' %}"></script>

<script>
  (function(){
    // Troca de abas via clicks na navbar
    const links = document.querySelectorAll('.app-nav a');
    const sections = document.querySelectorAll('.tab-view');

    function activate(targetId){
      sections.forEach(s => s.classList.toggle('active', s.id === targetId));
      links.forEach(a => a.classList.toggle('active', a.dataset.target === targetId));
      localStorage.setItem('mpay.activeTab', targetId);
    }

    links.forEach(a => {
      a.addEventListener('click', (e) => {
        e.preventDefault();
        const id = a.dataset.target;
        history.replaceState(null, '', '#tab=' + id.replace('tab-',''));
        activate(id);
      });
    });

    // Restaura da hash/localStorage
    const fromHash = (location.hash || '').replace('#tab=', '').trim();
    const saved = localStorage.getItem('mpay.activeTab');
    const target = fromHash ? 'tab-' + fromHash : (saved || 'tab-landing');
    if (document.getElementById(target)) activate(target);

    // Feather (se disponível)
    try { if (window.feather) window.feather.replace(); } catch(e){}
  })();
</script>
</body>
</html>
